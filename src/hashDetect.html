<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <title>Hash Detection Example - Insight Nexus</title>
    <!-- Licensed under the GNU Affero General Public License v3.0 (AGPL-3.0) -->
    <link rel="stylesheet" href="css/styles.css" />
    <link rel="stylesheet" href="css/guide.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;600&display=swap" rel="stylesheet">
</head>

<body class="guide-page">
    <button class="back-button" onclick="window.history.back()">‚Üê Back to Guide</button>

    <div class="guide-container">
        <div class="guide-header">
            <h1 class="guide-title">Hash Detection Example</h1>
            <p class="guide-subtitle">Hash type detection with node creation</p>
        </div>

        <div class="guide-section">
            <div class="section-content">
                <div class="code-block">
                    <pre>import sys, json, re
hash_input = sys.argv[1].strip()
nodes = []

try:
    # Remove common prefixes/suffixes
    clean_hash = re.sub(r'^(md5|sha1|sha256|sha512|ntlm|lm|bcrypt|scrypt|pbkdf2)[:\s]*', '', hash_input.lower())
    clean_hash = re.sub(r'[:\s\-_]+', '', clean_hash)
    
    # Hash length patterns
    hash_patterns = {
        32: ["MD5", "MD4", "MD2", "NTLM", "LM"],
        40: ["SHA1", "RIPEMD-160"],
        56: ["SHA-224"],
        64: ["SHA-256", "SHA3-256", "BLAKE2s-256", "BLAKE2b-256"],
        96: ["SHA-384", "SHA3-384", "BLAKE2b-384"],
        128: ["SHA-512", "SHA3-512", "BLAKE2b-512", "Whirlpool"],
        8: ["CRC32"],
        16: ["CRC64"],
        24: ["DES"],
        48: ["DES-EDE3"],
        60: ["bcrypt"],
        86: ["scrypt"]
    }
    
    # Length-based detection
    hash_length = len(clean_hash)
    possible_types = hash_patterns.get(hash_length, [])
    
    nodes.append(f"Hash Length: {hash_length} characters")
    
    if possible_types:
        # Show the most likely type first
        if hash_length == 32:
            nodes.append("Most Likely: MD5 or NTLM")
        elif hash_length == 40:
            nodes.append("Most Likely: SHA1")
        elif hash_length == 64:
            nodes.append("Most Likely: SHA-256")
        elif hash_length == 128:
            nodes.append("Most Likely: SHA-512")
        elif hash_length == 60:
            nodes.append("Most Likely: bcrypt")
        else:
            nodes.append(f"Most Likely: {possible_types[0]}")
    else:
        nodes.append("Unknown hash type")
    
    if not nodes:
        print(json.dumps({"nodes": [f"Unable to analyze hash: {hash_input}"], "files": []}))
    else:
        print(json.dumps({"nodes": nodes, "files": []}))
    
except Exception as e:
    print(json.dumps({"nodes": [f"Error analyzing hash: {str(e)}"], "files": []}))</pre>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Add dark mode support
        function toggleDarkMode() {
            document.body.classList.toggle('dark-mode');
        }

        // Check for existing dark mode preference
        if (localStorage.getItem('darkMode') === 'true') {
            document.body.classList.add('dark-mode');
        }

        // Save dark mode preference
        document.addEventListener('DOMContentLoaded', function() {
            const darkModeToggle = document.createElement('button');
            darkModeToggle.innerHTML = 'üåô';
            darkModeToggle.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: var(--primary-gradient);
                color: white;
                border: none;
                padding: 12px;
                border-radius: 50%;
                cursor: pointer;
                font-size: 18px;
                z-index: 1000;
                box-shadow: var(--shadow-light);
                transition: var(--transition-smooth);
            `;
            darkModeToggle.onclick = function() {
                toggleDarkMode();
                localStorage.setItem('darkMode', document.body.classList.contains('dark-mode'));
            };
            document.body.appendChild(darkModeToggle);
        });
    </script>
</body>

</html>
